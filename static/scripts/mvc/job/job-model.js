"use strict";define(["mvc/history/history-contents","mvc/dataset/states","utils/ajax-queue","mvc/base-mvc","utils/localization"],function(t,e,n,i,o){var s=i.SearchableModelMixin,a=Backbone.Model.extend(i.LoggableMixin).extend(i.mixin(s,{_logNamespace:"jobs",defaults:{model_class:"Job",tool_id:null,exit_code:null,inputs:{},outputs:{},params:{},create_time:null,update_time:null,state:e.NEW},parse:function(t,e){return t.params=this.parseParams(t.params),t},parseParams:function(t){var e={};return _.each(t,function(t,n){e[n]=JSON.parse(t)}),e},initialize:function(e,n){this.debug(this+"(Job).initialize",e,n),this.set("params",this.parseParams(this.get("params")),{silent:!0}),this.outputCollection=e.outputCollection||new t.HistoryContents([]),this._setUpListeners()},_setUpListeners:function(){this.on("change:state",function(t,e){this.log(this+" has changed state:",t,e),this.inReadyState()&&this.trigger("state:ready",t,e,this.previous("state"))})},inReadyState:function(){return _.contains(e.READY_STATES,this.get("state"))},hasDetails:function(){return!_.isEmpty(this.get("outputs"))},urlRoot:Galaxy.root+"api/jobs",toString:function(){return["Job(",this.get("id"),":",this.get("tool_id"),")"].join("")}}));return{Job:a,JobCollection:Backbone.Collection.extend(i.LoggableMixin).extend({_logNamespace:"jobs",model:a,urlRoot:Galaxy.root+"api/jobs",url:function(){return this.urlRoot},intialize:function(t,e){console.debug(t,e)},ids:function(){return this.map(function(t){return t.get("id")})},notReady:function(){return this.filter(function(t){return!t.inReadyState()})},haveDetails:function(){return this.all(function(t){return t.hasDetails()})},queueDetailFetching:function(){var t=this,e=new n.AjaxQueue(this.map(function(t){return function(){return t.fetch({silent:!0})}}));return e.done(function(){t.trigger("details-loaded")}),e},matches:function(t){return this.filter(function(e){return e.matches(t)})},toString:function(){return["JobCollection(",this.length,")"].join("")}},{fromHistory:function(t){console.debug(this);var e=new this([]);return e.fetch({data:{history_id:t}}).done(function(){window.queue=e.queueDetailFetching()}),e}})}});
//# sourceMappingURL=../../../maps/mvc/job/job-model.js.map
