"use strict";define(["mvc/list/list-item","mvc/dataset/dataset-li","mvc/base-mvc","utils/localization"],function(e,t,i,l){var s=e.FoldoutListItemView,a=e.ListItemView,o=s.extend({className:s.prototype.className+" dataset-collection",id:function(){return["dataset_collection",this.model.get("id")].join("-")},initialize:function(e){this.linkTarget=e.linkTarget||"_blank",this.hasUser=e.hasUser,s.prototype.initialize.call(this,e)},_setUpListeners:function(){s.prototype._setUpListeners.call(this),this.listenTo(this.model,"change",function(e,t){_.has(e.changed,"deleted")?this.render():_.has(e.changed,"element_count")&&this.$("> .title-bar .subtitle").replaceWith(this._renderSubtitle())})},_renderSubtitle:function(){return $(this.templates.subtitle(this.model.toJSON(),this))},_getFoldoutPanelOptions:function(){var e=s.prototype._getFoldoutPanelOptions.call(this);return _.extend(e,{linkTarget:this.linkTarget,hasUser:this.hasUser})},$selector:function(){return this.$("> .selector")},toString:function(){return"DCListItemView("+(this.model?this.model+"":"(no model)")+")"}});o.prototype.templates=function(){var e=_.extend({},s.prototype.templates.warnings,{error:i.wrapTemplate(["<% if( model.error ){ %>",'<div class="errormessagesmall">',l("There was an error getting the data for this collection"),": <%- model.error %>","</div>","<% } %>"]),purged:i.wrapTemplate(["<% if( model.purged ){ %>",'<div class="purged-msg warningmessagesmall">',l("This collection has been deleted and removed from disk"),"</div>","<% } %>"]),deleted:i.wrapTemplate(["<% if( model.deleted && !model.purged ){ %>",'<div class="deleted-msg warningmessagesmall">',l("This collection has been deleted"),"</div>","<% } %>"])}),t=i.wrapTemplate(['<div class="title-bar clear" tabindex="0">','<div class="title">','<span class="name"><%- collection.element_identifier || collection.name %></span>',"</div>",'<div class="subtitle"></div>',"</div>"],"collection"),a=i.wrapTemplate(['<div class="subtitle">','<% var countText = collection.element_count? ( collection.element_count + " " ) : ""; %>','<%        if( collection.collection_type === "list" ){ %>',l("a list of <%- countText %>datasets"),'<% } else if( collection.collection_type === "paired" ){ %>',l("a pair of datasets"),'<% } else if( collection.collection_type === "list:paired" ){ %>',l("a list of <%- countText %>dataset pairs"),'<% } else if( collection.collection_type === "list:list" ){ %>',l("a list of <%- countText %>dataset lists"),"<% } %>","</div>"],"collection");return _.extend({},s.prototype.templates,{warnings:e,titleBar:t,subtitle:a})}();var n=a.extend({className:a.prototype.className+" dataset-collection-element",initialize:function(e){e.logger&&(this.logger=this.model.logger=e.logger),this.log("DCEListItemView.initialize:",e),a.prototype.initialize.call(this,e)},toString:function(){return"DCEListItemView("+(this.model?this.model+"":"(no model)")+")"}});n.prototype.templates=function(){var e=i.wrapTemplate(['<div class="title-bar clear" tabindex="0">','<div class="title">','<span class="name"><%- element.element_identifier %></span>',"</div>",'<div class="subtitle"></div>',"</div>"],"element");return _.extend({},a.prototype.templates,{titleBar:e})}();var r=t.DatasetListItemView.extend({className:t.DatasetListItemView.prototype.className+" dataset-collection-element",initialize:function(e){e.logger&&(this.logger=this.model.logger=e.logger),this.log("DatasetDCEListItemView.initialize:",e),t.DatasetListItemView.prototype.initialize.call(this,e)},_fetchModelDetails:function(){var e=this;return e.model.inReadyState()&&!e.model.hasDetails()?e.model.fetch({silent:!0}):jQuery.when()},toString:function(){return"DatasetDCEListItemView("+(this.model?this.model+"":"(no model)")+")"}});r.prototype.templates=function(){var e=i.wrapTemplate(['<div class="title-bar clear" tabindex="0">','<span class="state-icon"></span>','<div class="title">','<span class="name"><%- element.element_identifier %></span>',"</div>","</div>"],"element");return _.extend({},t.DatasetListItemView.prototype.templates,{titleBar:e})}();var c=o.extend({className:o.prototype.className+" dataset-collection-element",_swapNewRender:function(e){o.prototype._swapNewRender.call(this,e);var t=this.model.get("state")||"ok";return this.$el.addClass("state-"+t),this.$el},toString:function(){return"NestedDCDCEListItemView("+(this.model?this.model+"":"(no model)")+")"}});return{DCListItemView:o,DCEListItemView:n,DatasetDCEListItemView:r,NestedDCDCEListItemView:c}});
//# sourceMappingURL=../../../maps/mvc/collection/collection-li.js.map
