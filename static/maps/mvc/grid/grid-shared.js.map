{"version":3,"sources":["mvc/grid/grid-shared.js"],"names":["define","GridView","View","Backbone","extend","initialize","options","$","this","self","Model","setElement","get","model","ajax","url","Galaxy","root","success","response","render","params","set","grid","attributes","_templateShared","append","$el","shared_by_others","$table","_","$tmpl","length","each","it","index","display_url","item","username","slug","escape","title","toLowerCase"],"mappings":"aACAA,QAAQ,sBAAuB,SAASC,GAuFpC,OACIC,KAzFRC,SAAAD,KAAAE,QACQC,WAAA,SAARC,GACQJ,IAAOC,EAAAA,KACPE,KAAAA,WAAYE,EAAA,WACRC,KAAIC,MAAO,IAAXN,SAAAO,MAAAJ,GACAE,KAAKG,KAAAA,KAAWJ,MAAEK,IAAlB,QACAJ,KAAKK,MAAQL,KAAIL,MAAAA,IAASO,UAC1BH,EAAAO,MACAC,IACOC,OAAAC,KACHF,KACIC,KAMJE,IACIC,KAAAA,MAASP,IAAA,aACTH,IACAA,EAAAA,MAAKW,OAALC,QACHH,QAAA,SAAAC,GAZLA,EAAA,aAAA,EAPwBV,EAAAI,MAAAS,IAAAH,GAkBhBV,EAAKW,aAShBA,OA3B2B,WAwBxB,IAAIG,EAAO,IAAItB,EAASO,KAAKK,MAAMW,YAKvCC,KAAAA,IAAAA,QAAiBC,OAAAH,EAAAI,KACbnB,KAAIC,IAAAA,OAAJD,KAAAiB,oBASAA,gBACYG,WAGR,IAAAnB,EAAIoB,KAQJC,EAAOxB,EACH,YADJE,KAAAK,MAAAD,IAAA,UAuBAmB,yCAOHzB,EAAAE,KAAAK,MAAAW,WACD,GACHlB,EAAAsB,kBAnFLtB,EAAAsB,iBAAAI,OAAA,EA0CU,CA4CH,IAAAH,EAAAtB,EACGL,+IApCE4B,EAAEG,KAAK3B,EAAQsB,iBAAkB,SAASM,EAAIC,GAC1C,IAAIC,EACApB,OAAOC,KACPR,EAAK4B,KACL,0CACAH,EAAGI,SACH,SACAJ,EAAGK,KACPV,EAAOH,OACH,oBAGIU,EACA,KACAN,EAAEU,OAAON,EAAGO,OACZ,gBAGAX,EAAEU,OAAON,EAAGI,UACZ,gBAIZP,EAAML,OAAOG,QAEbE,EAAML,OACF,MACIlB,KAAKK,MAAMD,IAAI,UAAU8B,cACzB,+BAGZ,OAAOX","file":"../../../scripts/mvc/grid/grid-shared.js","sourcesContent":["/** This class renders the grid list with shared section. */\ndefine([\"mvc/grid/grid-view\"], function(GridView) {\n    var View = Backbone.View.extend({\n        initialize: function(options) {\n            var self = this;\n            this.setElement($(\"<div/>\"));\n            this.model = new Backbone.Model(options);\n            this.item = this.model.get(\"item\");\n            this.title = this.model.get(\"plural\");\n            $.ajax({\n                url:\n                    Galaxy.root +\n                    this.item +\n                    \"/\" +\n                    this.model.get(\"action_id\") +\n                    \"?\" +\n                    $.param(Galaxy.params),\n                success: function(response) {\n                    response[\"dict_format\"] = true;\n                    self.model.set(response);\n                    self.render();\n                }\n            });\n        },\n\n        render: function() {\n            var grid = new GridView(this.model.attributes);\n            this.$el.empty().append(grid.$el);\n            this.$el.append(this._templateShared());\n        },\n\n        _templateShared: function() {\n            var self = this;\n            var $tmpl = $(\n                \"<div>\" +\n                    \"<h2>\" +\n                    this.model.get(\"plural\") +\n                    \" shared with you by others</h2>\" +\n                    \"</div>\"\n            );\n            var options = this.model.attributes;\n            if (\n                options.shared_by_others &&\n                options.shared_by_others.length > 0\n            ) {\n                var $table = $(\n                    '<table class=\"colored\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" width=\"100%\">' +\n                        '<tr class=\"header\">' +\n                        \"<th>Title</th>\" +\n                        \"<th>Owner</th>\" +\n                        \"</tr>\" +\n                        \"</table>\"\n                );\n                _.each(options.shared_by_others, function(it, index) {\n                    var display_url =\n                        Galaxy.root +\n                        self.item +\n                        \"/display_by_username_and_slug?username=\" +\n                        it.username +\n                        \"&slug=\" +\n                        it.slug;\n                    $table.append(\n                        \"<tr>\" +\n                            \"<td>\" +\n                            '<a href=\"' +\n                            display_url +\n                            '\">' +\n                            _.escape(it.title) +\n                            \"</a>\" +\n                            \"</td>\" +\n                            \"<td>\" +\n                            _.escape(it.username) +\n                            \"</td>\" +\n                            \"</tr>\"\n                    );\n                });\n                $tmpl.append($table);\n            } else {\n                $tmpl.append(\n                    \"No \" +\n                        this.model.get(\"plural\").toLowerCase() +\n                        \" have been shared with you.\"\n                );\n            }\n            return $tmpl;\n        }\n    });\n\n    return {\n        View: View\n    };\n});\n"]}