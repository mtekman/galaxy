{"version":3,"sources":["mvc/workflow/workflow-view-data.js"],"names":["define","Globals","DataInputView","Backbone","View","extend","className","options","this","input","initialize","nodeView","terminalElement","label","$el","skipResize","css","left","position","display","el","updateMaxWidth","outerWidth","$","DataOutputView","output","name","node","extensions","indexOf","isInput","join","html","calloutView","type","OutputCalloutView","append","hover","hoverImage","resetImage","top","detach","redrawWorkflowOutput","tagName","view","attr","outputName","addWorkflowOutput","canvas_manager","Galaxy","root","click","isWorkflowOutput","removeWorkflowOutput","workflow","has_changes","draw_overview","tooltip","delay","title","margin","right","show"],"mappings":"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","file":"../../../scripts/mvc/workflow/workflow-view-data.js","sourcesContent":["define([\"mvc/workflow/workflow-globals\"], function(Globals) {\n    var DataInputView = Backbone.View.extend({\n        className: \"form-row dataRow input-data-row\",\n\n        initialize: function(options) {\n            this.input = options.input;\n            this.nodeView = options.nodeView;\n            this.terminalElement = options.terminalElement;\n\n            this.$el.attr(\"name\", this.input.name).html(this.input.label);\n\n            if (!options.skipResize) {\n                this.$el.css({\n                    position: \"absolute\",\n                    left: -1000,\n                    top: -1000,\n                    display: \"none\"\n                });\n                $(\"body\").append(this.el);\n                this.nodeView.updateMaxWidth(this.$el.outerWidth());\n                this.$el.css({\n                    position: \"\",\n                    left: \"\",\n                    top: \"\",\n                    display: \"\"\n                });\n                this.$el.remove();\n            }\n        }\n    });\n\n    var DataOutputView = Backbone.View.extend({\n        className: \"form-row dataRow\",\n\n        initialize: function(options) {\n            this.output = options.output;\n            this.terminalElement = options.terminalElement;\n            this.nodeView = options.nodeView;\n\n            var output = this.output;\n            var label = output.name;\n            var node = this.nodeView.node;\n\n            var isInput =\n                output.extensions.indexOf(\"input\") >= 0 ||\n                output.extensions.indexOf(\"input_collection\") >= 0;\n            if (!isInput) {\n                label = label + \" (\" + output.extensions.join(\", \") + \")\";\n            }\n            this.$el.html(label);\n            this.calloutView = null;\n            if ([\"tool\", \"subworkflow\"].indexOf(node.type) >= 0) {\n                var calloutView = new OutputCalloutView({\n                    label: label,\n                    output: output,\n                    node: node\n                });\n                this.calloutView = calloutView;\n                this.$el.append(calloutView.el);\n                this.$el.hover(\n                    function() {\n                        calloutView.hoverImage();\n                    },\n                    function() {\n                        calloutView.resetImage();\n                    }\n                );\n            }\n            this.$el.css({\n                position: \"absolute\",\n                left: -1000,\n                top: -1000,\n                display: \"none\"\n            });\n            $(\"body\").append(this.el);\n            this.nodeView.updateMaxWidth(this.$el.outerWidth() + 17);\n            this.$el\n                .css({\n                    position: \"\",\n                    left: \"\",\n                    top: \"\",\n                    display: \"\"\n                })\n                .detach();\n        },\n        redrawWorkflowOutput: function() {\n            if (this.calloutView) {\n                this.calloutView.resetImage();\n            }\n        }\n    });\n\n    var OutputCalloutView = Backbone.View.extend({\n        tagName: \"div\",\n\n        initialize: function(options) {\n            this.label = options.label;\n            this.node = options.node;\n            this.output = options.output;\n\n            var view = this;\n            var node = this.node;\n            this.$el\n                .attr(\"class\", \"callout \" + this.label)\n                .css({ display: \"none\" })\n                .append(\n                    $(\"<div class='buttons'></div>\").append(\n                        $(\"<img/>\")\n                            .attr(\n                                \"src\",\n                                Galaxy.root +\n                                    \"static/images/fugue/asterisk-small-outline.png\"\n                            )\n                            .click(function() {\n                                var outputName = view.output.name;\n                                if (node.isWorkflowOutput(outputName)) {\n                                    node.removeWorkflowOutput(outputName);\n                                    view\n                                        .$(\"img\")\n                                        .attr(\n                                            \"src\",\n                                            Galaxy.root +\n                                                \"static/images/fugue/asterisk-small-outline.png\"\n                                        );\n                                } else {\n                                    node.addWorkflowOutput(outputName);\n                                    view\n                                        .$(\"img\")\n                                        .attr(\n                                            \"src\",\n                                            Galaxy.root +\n                                                \"static/images/fugue/asterisk-small.png\"\n                                        );\n                                }\n                                Globals.workflow.has_changes = true;\n                                Globals.canvas_manager.draw_overview();\n                            })\n                    )\n                )\n                .tooltip({\n                    delay: 500,\n                    title:\n                        \"Mark dataset as a workflow output. All unmarked datasets will be hidden.\"\n                });\n\n            this.$el.css({\n                top: \"50%\",\n                margin: \"-8px 0px 0px 0px\",\n                right: 8\n            });\n            this.$el.show();\n            this.resetImage();\n        },\n\n        resetImage: function() {\n            if (!this.node.isWorkflowOutput(this.output.name)) {\n                this.$(\"img\").attr(\n                    \"src\",\n                    Galaxy.root +\n                        \"static/images/fugue/asterisk-small-outline.png\"\n                );\n            } else {\n                this.$(\"img\").attr(\n                    \"src\",\n                    Galaxy.root + \"static/images/fugue/asterisk-small.png\"\n                );\n            }\n        },\n\n        hoverImage: function() {\n            this.$(\"img\").attr(\n                \"src\",\n                Galaxy.root + \"static/images/fugue/asterisk-small-yellow.png\"\n            );\n        }\n    });\n\n    return {\n        DataInputView: DataInputView,\n        DataOutputView: DataOutputView\n    };\n});\n"]}