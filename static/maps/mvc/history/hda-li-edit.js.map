{"version":3,"sources":["mvc/history/hda-li-edit.js"],"names":["define","_super","DATASET_LI_EDIT","DatasetListItemEdit","HDAListItemEdit","extend","className","prototype","_fetchModelDetails","view","this","model","inReadyState","hasDetails","has","fetch","silent","clone","data","keys","join","events","_","click .unhide-link","ev","unhide","toString","templates","warnings","titleBar","HDA_LI","HDAListItemView","_l"],"mappings":"aAAAA,QAEQ,8BAMA,qBAJA,eAMA,sBACA,SAAIC,EAASC,EAAgBC,EAAAA,GAIzB,IAAAF,EAAAC,EAAAC,oBAGIC,EAAAH,EAAAI,QAFAC,UAAWL,EAAOM,UAAUD,UAAY,mBAKxCE,mBAAoB,WAKZ,IAAAC,EAAAC,KACA,OAAAD,EAAAE,MAAAC,iBAAAH,EAAAE,MAAAE,aACaF,EAAMG,MAAIC,OAAAC,QAAe,IAI9BP,EAAAE,MAAAG,IAAA,cASGG,OAAMhB,OARFQ,EAAAE,MAAAI,OAFLC,QAAA,EAFVE,MAQJC,MAAA,aAAA,gBAAAC,KAAA,SAQCC,OAAAC,EAAAjB,OAAAiB,EAAAL,MAAAhB,EAAAM,UAAAc,SA9B+BE,qBAAA,SAAAC,GAiCpC,OALQd,KAAKC,MAAMc,UAKnB,KAlCRC,SAAA,WA8CgBnB,MAAAA,oBAVcG,KAAKC,MAQnCD,KAAAC,MAAA,GACA,cACkD,OA0BlD,OARIP,EAAgBG,UAAIN,UAAiB0B,WACjC,IAAAC,EAAAN,EAAAjB,UAAAJ,EAAAM,UAAAoB,UAAAC,UACAC,OAAUC,EAAOC,cAFrB,gCAZY,+CAmBhBC,EAAA,gCACO,6DACH5B,EAAiBA,aADrB,OAtFR,SAwEwB,WAEJ,aAIR,OAAOkB,EAAEjB,UAAWJ,EAAOM,UAAUoB,WAEjCE,SAAUC,EAAOC,gBAAgBxB,UAAUoB,UAAUE,SACrDD,SAAUA,IAHuBD,IASrCvB,gBAAiBA","file":"../../../scripts/mvc/history/hda-li-edit.js","sourcesContent":["define(\n    [\n        \"mvc/dataset/dataset-li-edit\",\n        \"mvc/history/hda-li\",\n        \"mvc/base-mvc\",\n        \"utils/localization\"\n    ],\n    function(DATASET_LI_EDIT, HDA_LI, BASE_MVC, _l) {\n        \"use strict\";\n\n        //==============================================================================\n        var _super = DATASET_LI_EDIT.DatasetListItemEdit;\n        /** @class Editing view for HistoryDatasetAssociation.\n */\n        var HDAListItemEdit = _super.extend(\n            /** @lends HDAListItemEdit.prototype */ {\n                className: _super.prototype.className + \" history-content\",\n\n                /** In this override, only get details if in the ready state, get rerunnable if in other states.\n     *  Note: fetch with no 'change' event triggering to prevent automatic rendering.\n     */\n                _fetchModelDetails: function() {\n                    var view = this;\n                    if (view.model.inReadyState() && !view.model.hasDetails()) {\n                        return view.model.fetch({ silent: true });\n\n                        // special case the need for the rerunnable and creating_job attributes\n                        // needed for rendering re-run button on queued, running datasets\n                    } else if (!view.model.has(\"rerunnable\")) {\n                        return view.model.fetch({\n                            silent: true,\n                            data: {\n                                // only fetch rerunnable and creating_job to keep overhead down\n                                keys: [\"rerunnable\", \"creating_job\"].join(\",\")\n                            }\n                        });\n                    }\n                    return jQuery.when();\n                },\n\n                /** event map */\n                events: _.extend(_.clone(_super.prototype.events), {\n                    \"click .unhide-link\": function(ev) {\n                        this.model.unhide();\n                        return false;\n                    }\n                }),\n\n                /** string rep */\n                toString: function() {\n                    var modelString = this.model\n                        ? this.model + \"\"\n                        : \"(no model)\";\n                    return \"HDAListItemEdit(\" + modelString + \")\";\n                }\n            }\n        );\n\n        // ............................................................................ TEMPLATES\n        /** underscore templates */\n        HDAListItemEdit.prototype.templates = (function() {\n            var warnings = _.extend({}, _super.prototype.templates.warnings, {\n                hidden: BASE_MVC.wrapTemplate(\n                    [\n                        \"<% if( !dataset.visible ){ %>\",\n                        // add a link to unhide a dataset\n                        '<div class=\"hidden-msg warningmessagesmall\">',\n                        _l(\"This dataset has been hidden\"),\n                        '<br /><a class=\"unhide-link\" a href=\"javascript:void(0);\">',\n                        _l(\"Unhide it\"),\n                        \"</a>\",\n                        \"</div>\",\n                        \"<% } %>\"\n                    ],\n                    \"dataset\"\n                )\n            });\n\n            return _.extend({}, _super.prototype.templates, {\n                //NOTE: *steal* the HDAListItemView titleBar\n                titleBar: HDA_LI.HDAListItemView.prototype.templates.titleBar,\n                warnings: warnings\n            });\n        })();\n\n        //==============================================================================\n        return {\n            HDAListItemEdit: HDAListItemEdit\n        };\n    }\n);\n"]}