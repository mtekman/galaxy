{"version":3,"sources":["mvc/history/history-list.js"],"names":["define","View","title","initialize","Utils","setElement","HistoryModel","historyCopyDialog","model","Backbone","get","url","Galaxy","options","success","this","response","$","_","Model","operation","self","action_id","set","render","each","label","onclick","id","_showCopyDialog","grid","window","parent","currHistoryPanel","history","History","fetch","fail","alert","done","loadCurrentHistory","location","reload"],"mappings":"aACAA,QAEQ,cAMIC,qBACAC,4BACAC,2BAEI,SAAAC,EAAKC,EAAaC,EAAlBC,GAqDR,OACIN,KArDSO,SAAQP,KAAIQ,QACjBL,MAAMM,YACFC,WACIC,SAAAC,GAKJC,IAAAA,EAASC,KACLC,KAAAA,WAASC,EAAA,WACTC,KAAAA,MAAOF,IAAAA,SAASG,MACZf,EAAAM,KACIU,IACIC,OAAAA,KACH,WACJR,EAAAS,UALL,IAOAD,EAAKb,MAAMe,OAAIP,QACfK,QAAKG,SAALR,GACHA,EAAA,aAAA,EAlBLE,EAAAO,KAAAT,EAAA,WAAA,SAAAI,GANwB,QAAAA,EAAAM,QAiBRN,EAAUO,QAAU,SAASC,GAW9BP,EAAAQ,gBAAAD,OANPP,EAAKb,MAAMe,IAAIP,GAW3Ba,EAAiBL,aAULjB,OAAAA,WACI,IAAAuB,EACIC,IAAOC,EAAPjB,KACAgB,MAAOC,YAGPD,KAAAA,IAAAA,QAAOC,OAAOpB,EAAOqB,MAG5BJ,gBATD,SAAAD,GARR,IAAAM,EAAA,IAAA5B,EAAA6B,SAAAP,GAAAA,IAmBHM,EAtDLE,QAqCaC,KAAK,WAoBXC,MACGrC,mEAhBGsC,KAAK,WACFhC,EAAkB2B,MAAaK,KAAK,WAE5BR,OAAOC,QACPD,OAAOC,OAAOpB,QACdmB,OAAOC,OAAOpB,OAAOqB,kBAErBF,OAAOC,OAAOpB,OAAOqB,iBAAiBO,qBAE1CT,OAAOU,SAASC,QAAO","file":"../../../scripts/mvc/history/history-list.js","sourcesContent":["/** This class renders the grid list. */\ndefine(\n    [\n        \"utils/utils\",\n        \"mvc/grid/grid-view\",\n        \"mvc/history/history-model\",\n        \"mvc/history/copy-dialog\"\n    ],\n    function(Utils, GridView, HistoryModel, historyCopyDialog) {\n        var View = Backbone.View.extend({\n            title: \"Histories\",\n            initialize: function(options) {\n                var self = this;\n                this.setElement($(\"<div/>\"));\n                this.model = new Backbone.Model();\n                Utils.get({\n                    url:\n                        Galaxy.root +\n                        \"history/\" +\n                        options.action_id +\n                        \"?\" +\n                        $.param(Galaxy.params),\n                    success: function(response) {\n                        response[\"dict_format\"] = true;\n                        _.each(response[\"operations\"], function(operation) {\n                            if (operation.label == \"Copy\") {\n                                operation.onclick = function(id) {\n                                    self._showCopyDialog(id);\n                                };\n                            }\n                        });\n                        self.model.set(response);\n                        self.render();\n                    }\n                });\n            },\n\n            render: function() {\n                var grid = new GridView(this.model.attributes);\n                this.$el.empty().append(grid.$el);\n            },\n\n            _showCopyDialog: function(id) {\n                var history = new HistoryModel.History({ id: id });\n                history\n                    .fetch()\n                    .fail(function() {\n                        alert(\n                            \"History could not be fetched. Please contact an administrator\"\n                        );\n                    })\n                    .done(function() {\n                        historyCopyDialog(history, {}).done(function() {\n                            if (\n                                window.parent &&\n                                window.parent.Galaxy &&\n                                window.parent.Galaxy.currHistoryPanel\n                            ) {\n                                window.parent.Galaxy.currHistoryPanel.loadCurrentHistory();\n                            }\n                            window.location.reload(true);\n                        });\n                    });\n            }\n        });\n\n        return {\n            View: View\n        };\n    }\n);\n"]}