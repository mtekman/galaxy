{"version":3,"sources":["layout/generic-nav-view.js"],"names":["define","Modal","GenericNavView","Backbone","View","extend","initialize","makeModalIframe","e","frame_height","frame_width","class_names","Galaxy","config","communication_server_host","header_template","window","communication_server_port","src","$el_chat_modal_body","username","escape","cls","$","remove","modal","show","$el_chat_modal_header","iframe_template","width","addClass","click","find","removeAttr","append","css","removeClass","attr","height","self","navItem","tooltip","visible","render","id","icon","onclick"],"mappings":"aACAA,QAAQ,mBAAoB,SAASC,GADrC,IAAAC,EAAAC,SAAAC,KAAAC,QACQC,WAAA,WACAJ,KAAAA,MAAiBC,MAMjBI,gBAAiB,SAASC,GAA1BD,IAwBQE,EAtBJ,KAuBIC,EAvBJ,KAwBIC,EATI,+DAjBZJ,OAAiBK,OAAAC,OAAAC,0BAoBTC,IAnBJC,OAAAJ,OAAAC,OAAAI,2BAYIC,aAXOF,OAAOJ,OAAOC,OAAOC,KAAAA,WAAAA,UAa5BK,mCAZ4BF,OAC5BG,OAAWC,OAAOL,OAAOJ,kCAyBvB,eA6DN,OAnDIU,EAAAA,eAAKX,OAAAA,GANTY,EAAA,eAAAC,SAUAtB,EAAeuB,MAAMC,IAArBzB,EAAAG,MACAuB,KAAAA,EACAR,OAXUS,IAYVC,MAXYpB,IAYZkB,gBAAAA,EACAR,iBAAoBW,EACpBH,IAbWjB,wBAiBXa,EAAEE,MAAgBM,OACdR,EAAAA,EAAqB,6BACxBJ,EAFDI,EAAA,2BAIAA,EAAEO,SAA0BC,qBACxBZ,EAAMW,SAAA,qBACFP,EAAES,KAAA,MAAAR,SACFD,EAAEU,WAAA,6BACFV,EAAEW,OA9BT,uPAkCOX,EAAAA,gBAAEQ,MAAA,SAAAvB,GACLe,EARD,eAQOY,IAAA,UAAA,UAGHZ,EAAAA,0BAAEQ,MAAF,SACKK,GAELb,EAAE,0BAA0Bc,SAAK,cACjCd,EAAE,6BAAFM,MAAgC,UACnCN,EAAA,2BAAAe,OAAA,SAjBLf,EAAA,0BAmBAa,YAAA,aAlFkCN,SAAA,eAsE1BP,EAAE,0BAA0Bc,KAAK,QAAS,YAetDd,EAAA,0BAAAY,IAAA,cAAA,WAEQI,EAAAA,6BAAJV,MAAAnB,SACI8B,EAAAA,2BADJF,OAAA7B,SAEA+B,EAAU,0BACFJ,YAAA,eACEN,SAAA,aACNW,EAAAA,0BAHMJ,KAAA,QAAA,YAINK,EAAAA,0BAJMP,IAAA,cAAA,YAOHK,MAIfG,OAAO,WAJC,OANIC,GAAI,mBACJC,KAAM,eACNJ,QAAS,cACTC,SAAS,EACTI,QAOR5C,KAPsBK,oBAM1B,OACIL,eAAgBA","file":"../../scripts/layout/generic-nav-view.js","sourcesContent":["/** Real-time Communication feature **/\ndefine([\"mvc/ui/ui-modal\"], function(Modal) {\n    var GenericNavView = Backbone.View.extend({\n        initialize: function() {\n            this.modal = null;\n        },\n\n        /** makes bootstrap modal and iframe inside it */\n        makeModalIframe: function(e) {\n            // make modal\n            var host = window.Galaxy.config.communication_server_host,\n                port = window.Galaxy.config.communication_server_port,\n                username = escape(window.Galaxy.user.attributes.username),\n                persistent_communication_rooms = escape(\n                    window.Galaxy.config.persistent_communication_rooms\n                ),\n                query_string =\n                    \"?username=\" +\n                    username +\n                    \"&persistent_communication_rooms=\" +\n                    persistent_communication_rooms,\n                src = host + \":\" + port + query_string,\n                $el_chat_modal_header = null,\n                $el_chat_modal_body = null,\n                iframe_template =\n                    '<iframe class=\"f-iframe fade in communication-iframe\" src=\"' +\n                    src +\n                    '\"> </iframe>',\n                header_template =\n                    '<i class=\"fa fa-comment\" aria-hidden=\"true\" title=\"Communicate with other users\"></i>' +\n                    '<i class=\"fa fa-expand expand-compress-modal\" aria-hidden=\"true\" title=\"Maximize\"></i>' +\n                    '<i class=\"fa fa-times close-modal\" aria-hidden=\"true\" title=\"Close\"></i>',\n                frame_height = 350,\n                frame_width = 600,\n                class_names = \"ui-modal chat-modal\";\n\n            // deletes the chat modal if already present and create one\n            if ($(\".chat-modal\").length > 0) {\n                $(\".chat-modal\").remove();\n            }\n            // creates a modal\n            GenericNavView.modal = new Modal.View({\n                body: iframe_template,\n                height: frame_height,\n                width: frame_width,\n                closing_events: true,\n                title_separator: false,\n                cls: class_names\n            });\n\n            // shows modal\n            GenericNavView.modal.show();\n            $el_chat_modal_header = $(\".chat-modal .modal-header\");\n            $el_chat_modal_body = $(\".chat-modal .modal-body\");\n            // adjusts the css of bootstrap modal for chat\n            $el_chat_modal_header.addClass(\"modal-header-body\");\n            $el_chat_modal_body.addClass(\"modal-header-body\");\n            $el_chat_modal_header.find(\"h4\").remove();\n            $el_chat_modal_header.removeAttr(\"min-height padding border\");\n            $el_chat_modal_header.append(header_template);\n            // click event of the close button for chat\n            $(\".close-modal\").click(function(e) {\n                $(\".chat-modal\").css(\"display\", \"none\");\n            });\n            // click event of expand and compress icon\n            $(\".expand-compress-modal\").click(function(e) {\n                if ($(\".expand-compress-modal\").hasClass(\"fa-expand\")) {\n                    $(\".chat-modal .modal-dialog\").width(\"1000px\");\n                    $(\".chat-modal .modal-body\").height(\"575px\");\n                    $(\".expand-compress-modal\")\n                        .removeClass(\"fa-expand\")\n                        .addClass(\"fa-compress\");\n                    $(\".expand-compress-modal\").attr(\"title\", \"Minimize\");\n                    $(\".expand-compress-modal\").css(\"margin-left\", \"96.2%\");\n                } else {\n                    $(\".chat-modal .modal-dialog\").width(frame_width + \"px\");\n                    $(\".chat-modal .modal-body\").height(frame_height + \"px\");\n                    $(\".expand-compress-modal\")\n                        .removeClass(\"fa-compress\")\n                        .addClass(\"fa-expand\");\n                    $(\".expand-compress-modal\").attr(\"title\", \"Maximize\");\n                    $(\".expand-compress-modal\").css(\"margin-left\", \"93.2%\");\n                }\n            });\n            return this;\n        },\n\n        /**renders the chat icon as a nav item*/\n        render: function() {\n            var self = this,\n                navItem = {};\n            navItem = {\n                id: \"show-chat-online\",\n                icon: \"fa-comment-o\",\n                tooltip: \"Chat online\",\n                visible: false,\n                onclick: self.makeModalIframe\n            };\n            return navItem;\n        }\n    });\n\n    return {\n        GenericNavView: GenericNavView\n    };\n});\n"]}