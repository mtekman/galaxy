{"version":3,"sources":["ui/mode-button.js"],"names":["factory","define","amd","jQuery","ModeButton","element","options","this","currModeIndex","prototype","DATA_KEY","switchModesOnClick","_init","$element","$","defaults","modes","Error","extend","modeButton","click","event","callModeFn","_incModeIndex","html","reset","length","_getModeIndex","modeKey","i","mode","_setModeByIndex","index","newMode","currentMode","current","getMode","hasMode","err","setMode","initialMode","modeFn","onclick","type","call","get","fn","map","$this","data","button","fnName","apply","makeArray","arguments","slice"],"mappings":"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","file":"../../scripts/ui/mode-button.js","sourcesContent":["// from: https://raw.githubusercontent.com/umdjs/umd/master/jqueryPlugin.js\n// Uses AMD or browser globals to create a jQuery plugin.\n(function(factory) {\n    if (typeof define === \"function\" && define.amd) {\n        //TODO: So...this turns out to be an all or nothing thing. If I load jQuery in the define below, it will\n        //  (of course) wipe the old jquery *and all the plugins loaded into it*. So the define below *is still\n        //  relying on jquery being loaded globally* in order to preserve plugins.\n        define([], factory);\n    } else {\n        // Browser globals\n        factory(jQuery);\n    }\n})(function() {\n    /** Multi 'mode' button (or any element really) that changes the html\n     *      contents of itself when clicked. Pass in an ordered list of\n     *      objects with 'html' and (optional) onclick functions.\n     *\n     *      When clicked in a particular node, the onclick function will\n     *      be called (with the element as this) and the element will\n     *      switch to the next mode, replacing its html content with\n     *      that mode's html.\n     *\n     *      If there is no next mode, the element will switch back to\n     *      the first mode.\n     * @example:\n     *     $( '.myElement' ).modeButton({\n     *         modes : [\n     *             {\n     *                 mode: 'bler',\n     *                 html: '<h5>Bler</h5>',\n     *                 onclick : function(){\n     *                     $( 'body' ).css( 'background-color', 'red' );\n     *                 }\n     *             },\n     *             {\n     *                 mode: 'bloo',\n     *                 html: '<h4>Bloo</h4>',\n     *                 onclick : function(){\n     *                     $( 'body' ).css( 'background-color', 'blue' );\n     *                 }\n     *             },\n     *             {\n     *                 mode: 'blah',\n     *                 html: '<h3>Blah</h3>',\n     *                 onclick : function(){\n     *                     $( 'body' ).css( 'background-color', 'grey' );\n     *                 }\n     *             },\n     *         ]\n     *     });\n     *     $( '.myElement' ).modeButton( 'callModeFn', 'bler' );\n     */\n    /** constructor */\n    function ModeButton(element, options) {\n        this.currModeIndex = 0;\n        return this._init(element, options);\n    }\n\n    /** html5 data key to store this object inside an element */\n    ModeButton.prototype.DATA_KEY = \"mode-button\";\n    /** default options */\n    ModeButton.prototype.defaults = {\n        switchModesOnClick: true\n    };\n\n    // ---- private interface\n    /** set up options, intial mode, and the click handler */\n    ModeButton.prototype._init = function _init(element, options) {\n        //console.debug( 'ModeButton._init:', element, options );\n        options = options || {};\n        this.$element = $(element);\n        this.options = $.extend(true, {}, this.defaults, options);\n        if (!options.modes) {\n            throw new Error('ModeButton requires a \"modes\" array');\n        }\n\n        var modeButton = this;\n        this.$element.click(function _ModeButtonClick(event) {\n            // call the curr mode fn\n            modeButton.callModeFn();\n            // inc the curr mode index\n            if (modeButton.options.switchModesOnClick) {\n                modeButton._incModeIndex();\n            }\n            // set the element html\n            $(this).html(\n                modeButton.options.modes[modeButton.currModeIndex].html\n            );\n        });\n        return this.reset();\n    };\n    /** increment the mode index to the next in the array, looping back to zero if at the last */\n    ModeButton.prototype._incModeIndex = function _incModeIndex() {\n        this.currModeIndex += 1;\n        if (this.currModeIndex >= this.options.modes.length) {\n            this.currModeIndex = 0;\n        }\n        return this;\n    };\n    /** get the mode index in the modes array for the given key (mode name) */\n    ModeButton.prototype._getModeIndex = function _getModeIndex(modeKey) {\n        for (var i = 0; i < this.options.modes.length; i += 1) {\n            if (this.options.modes[i].mode === modeKey) {\n                return i;\n            }\n        }\n        throw new Error(\"mode not found: \" + modeKey);\n    };\n    /** set the current mode to the one with the given index and set button html */\n    ModeButton.prototype._setModeByIndex = function _setModeByIndex(index) {\n        var newMode = this.options.modes[index];\n        if (!newMode) {\n            throw new Error(\"mode index not found: \" + index);\n        }\n        this.currModeIndex = index;\n        if (newMode.html) {\n            this.$element.html(newMode.html);\n        }\n        return this;\n    };\n\n    // ---- public interface\n    /** get the current mode object (not just the mode name) */\n    ModeButton.prototype.currentMode = function currentMode() {\n        return this.options.modes[this.currModeIndex];\n    };\n    /** return the mode key of the current mode */\n    ModeButton.prototype.current = function current() {\n        // sugar for returning mode name\n        return this.currentMode().mode;\n    };\n    /** get the mode with the given modeKey or the current mode if modeKey is undefined */\n    ModeButton.prototype.getMode = function getMode(modeKey) {\n        if (!modeKey) {\n            return this.currentMode();\n        }\n        return this.options.modes[this._getModeIndex(modeKey)];\n    };\n    /** T/F if the button has the given mode */\n    ModeButton.prototype.hasMode = function hasMode(modeKey) {\n        try {\n            return !!this.getMode(modeKey);\n        } catch (err) {}\n        return false;\n    };\n    /** set the current mode to the mode with the given name */\n    ModeButton.prototype.setMode = function setMode(modeKey) {\n        return this._setModeByIndex(this._getModeIndex(modeKey));\n    };\n    /** reset to the initial mode */\n    ModeButton.prototype.reset = function reset() {\n        this.currModeIndex = 0;\n        if (this.options.initialMode) {\n            this.currModeIndex = this._getModeIndex(this.options.initialMode);\n        }\n        return this._setModeByIndex(this.currModeIndex);\n    };\n    /** manually call the click handler of the given mode */\n    ModeButton.prototype.callModeFn = function callModeFn(modeKey) {\n        var modeFn = this.getMode(modeKey).onclick;\n        if (modeFn && $.type(modeFn === \"function\")) {\n            // call with the element as context (std jquery pattern)\n            return modeFn.call(this.$element.get(0));\n        }\n        return undefined;\n    };\n\n    // as jq plugin\n    $.fn.modeButton = function $modeButton(options) {\n        if (!this.length) {\n            return this;\n        }\n\n        //TODO: does map still work with jq multi selection (i.e. $( '.class-for-many-btns' ).modeButton)?\n        if ($.type(options) === \"object\") {\n            return this.map(function() {\n                var $this = $(this);\n                $this.data(\"mode-button\", new ModeButton($this, options));\n                return this;\n            });\n        }\n\n        var $first = $(this[0]),\n            button = $first.data(\"mode-button\");\n\n        if (!button) {\n            throw new Error(\n                \"modeButton needs an options object or string name of a function\"\n            );\n        }\n\n        if (button && $.type(options) === \"string\") {\n            var fnName = options;\n            if (button && $.type(button[fnName]) === \"function\") {\n                return button[fnName].apply(\n                    button,\n                    $.makeArray(arguments).slice(1)\n                );\n            }\n        }\n        return button;\n    };\n});\n"]}